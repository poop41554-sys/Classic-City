import {
  Client,
  GatewayIntentBits,
  Partials,
  EmbedBuilder,
  ButtonBuilder,
  ButtonStyle,
  ActionRowBuilder,
  ModalBuilder,
  TextInputBuilder,
  TextInputStyle,
  StringSelectMenuBuilder
} from "discord.js";

import fs from "fs";

const config = JSON.parse(fs.readFileSync("./config.json", "utf8"));
const { token, guildId, channelId } = config;

const client = new Client({
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMembers,
    GatewayIntentBits.GuildMessages
  ],
  partials: [Partials.Channel]
});


const SECTORS = {
  police: { // Ø´Ø±Ø·Ø©
    hireRoles: {
      trainee: "1430989745005269154",
      wkil_aref: "1430989743780266215"
    },

    courseRole: "1430989724570357801",

    ranksToRemove: [
      "1430989743780266215","1430989741347704933","1430989742442287225","1430989740311580812",
      "1430989739292622908","1430989737862369331","1430989736616525975","1430989735303708693",
      "1430989733957337259","1430989732656971888","1430989731579039784","1430989730597568592",
      "1430989729259589752","1430989727775068170","1430989726663446658","1436611295721029794"
    ],

    rankRoles: {
      Ø¬Ù†Ø¯ÙŠ: "1430989741347704933",
      Ø¬Ù†Ø¯ÙŠ_Ø£ÙˆÙ„: "1430989742442287225",
      Ø±Ù‚ÙŠØ¨: "1430989740311580812",
      Ø±Ù‚ÙŠØ¨_Ø£ÙˆÙ„: "1430989739292622908",
      ÙˆÙƒÙŠÙ„_Ø¸Ø§Ø¨Ø·: "1430989737862369331",
      ÙˆÙƒÙŠÙ„_Ø¸Ø§Ø¨Ø·_Ø£ÙˆÙ„: "1430989736616525975",
      Ù…Ù„Ø§Ø²Ù…: "1430989735303708693",
      Ù…Ù„Ø§Ø²Ù…_Ø£ÙˆÙ„: "1430989733957337259",
      Ù†Ù‚ÙŠØ¨: "1430989732656971888",
      Ø±Ø§Ø¦Ø¯: "1430989731579039784",
      Ù…Ù‚Ø¯Ù…: "1430989730597568592",
      Ø¹Ù‚ÙŠØ¯: "1430989729259589752",
      Ø¹Ù…ÙŠØ¯: "1430989727775068170",
      Ù„ÙˆØ§Ø¡: "1430989726663446658",
      ÙØ±ÙŠÙ‚: "1436611295721029794"
    },

    courses: {
      "Ù…Ù†ØªØ¯Ø¨": "1430989725371728043",
      "Ù…Ø±ÙˆØ±": "1430989724570357801",
      "Ø¬Ù†Ø§Ø­ Ø¬ÙˆÙŠ": "1430989723404337272",
      "ÙØ±Ù‚Ø© Ø§Ù„Ù†Ø¬Ø¯Ø©": "1430989722284720320",
      "Ù‚Ø³Ù… Ø§Ù„ØªØ¬Ù†ÙŠØ¯": "1430989721193938995",
      "Ø§Ù„Ø£Ø¹Ù„Ø§Ù… Ø§Ù„Ø£Ù…Ù†ÙŠ": "1430989720128585950",
      "Ù…ÙƒØªØ¨ Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§Øª": "1430989718983671930",
      "Ù…Ø³Ø¤ÙˆÙ„ Ù…ÙƒØªØ¨ Ø§Ù„ØªØ­Ù‚ÙŠÙ‚Ø§Øª": "1436614417499295795",
      "Ø´Ø¤ÙˆÙ† Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø´Ø±Ø·Ø©": "1430989717910061239",
      "Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ùˆ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©": "1430989716379140228",
      "Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©": "1430989715317850162",
      "Ù…Ø­Ù‚Ù‚ Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©": "1430989714235854991",
      "Ù‚Ø§Ø¶ÙŠ Ø¹Ø³ÙƒØ±ÙŠ": "1430989713073770688",
      "Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ØªØ°Ø§ÙƒØ± Ù„Ù„Ø´Ø±Ø·Ø©": "1434867781861376090"
    }
  },
  customs: { // Ø¬Ù…Ø§Ø±Ùƒ
    hireRoles: { trainee: "1430989846360625162", wkil_aref: "1430989845248872569" },
    courseRole: "ROLE_ID",
    ranksToRemove: ["1430989845248872569","1430989844124925982","1430989842917097572","1430989841620926516","1430989840505245776","1430989839284703383","1430989838194053120","1430989837099597875","1430989836000563320","1430989834788274336","1430989833714536529","1430989832586526730","1430989831420383262","1430989829658775662","1430989828677435452","1436611938498121728","1436611934001692803"],
    rankRoles: { Ø¹Ø³ÙƒØ±ÙŠ: "1430989844124925982", Ø¹Ø³ÙƒØ±ÙŠ_Ø£ÙˆÙ„: "1430989842917097572", Ø±Ù‚ÙŠØ¨: "1430989841620926516", Ø±Ù‚ÙŠØ¨_Ø£ÙˆÙ„: "1430989840505245776", ÙˆÙƒÙŠÙ„_Ø¸Ø§Ø¨Ø·: "1430989839284703383", ÙˆÙƒÙŠÙ„_Ø¸Ø§Ø¨Ø·_Ø£ÙˆÙ„: "1430989838194053120", Ù…Ù„Ø§Ø²Ù…: "1430989837099597875", Ù…Ù„Ø§Ø²Ù…_Ø£ÙˆÙ„: "1430989836000563320", Ù†Ù‚ÙŠØ¨: "1430989834788274336", Ø±Ø§Ø¦Ø¯: "1430989833714536529", Ù…Ù‚Ø¯Ù…: "1430989832586526730", Ø¹Ù‚ÙŠØ¯: "1430989831420383262", Ø¹Ù…ÙŠØ¯: "1430989829658775662", Ù„ÙˆØ§Ø¡: "1430989828677435452", ÙØ±ÙŠÙ‚: "1436611938498121728", ÙØ±ÙŠÙ‚_Ø§ÙˆÙ„: "1436611934001692803"  },
    courses: { "Ù…Ù†ØªØ¯Ø¨": "1430989827612082358", "Ø¬Ù†Ø§Ø­ Ø¬ÙˆÙŠ": "1430989826051539004", "ÙØ±Ù‚Ø© Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ø£Ø³Ù†Ø§Ø¯": "1430989824591921212", "Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø£Ø±Ù‡Ø§Ø¨": "1430989823254073496", "Ø§Ù„Ø¥Ø¹Ù„Ø§Ù… Ø§Ù„Ø£Ù…Ù†ÙŠ": "1430989822125805861", "Ø®ÙØ± Ø³ÙˆØ§Ø­Ù„": "1430989820347547649", "Ù‚Ø³Ù… Ø§Ù„ØªØ¬Ù†ÙŠØ¯": "1430989819684851712", "Ø´Ø¤ÙˆÙ† Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø­Ø±Ø³": "1430989818459979846", "Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ùˆ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©": "1430989817252024351", "Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©": "1430989816023224421", "Ù…Ø­Ù‚Ù‚ Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©": "1430989814278131823", "Ù‚Ø§Ø¶ÙŠ Ø¹Ø³ÙƒØ±ÙŠ": "1430989813389197463", "Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ØªØ°Ø§ÙƒØ± Ù„Ù„Ø¬Ù…Ø§Ø±Ùƒ": "1434867820583321610" }
  },
  garage: { // Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ
    hireRoles: { trainee: "1430989808796303540", wkil_aref: "1430989807353331885" },
    courseRole: "ROLE_ID",
    ranksToRemove: ["1430989807353331885","1430989805990318101","1430989804706988133","1430989803410817044","1430989801842151525","1430989800680194109","1430989799510114444","1430989798478188626","1430989797316624384","1430989795848491108"],
    rankRoles: { Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ_Ù…Ø³ØªÙˆÙŠ_1: "1430989805990318101", Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ_Ù…Ø³ØªÙˆÙŠ_2: "1430989804706988133", Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ_Ù…Ø³ØªÙˆÙŠ_3: "1430989803410817044", Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ_Ù…Ø³ØªÙˆÙŠ_4: "1430989801842151525", Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ_Ù…Ø³ØªÙˆÙŠ_5: "1430989800680194109" ,  Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ_Ù…Ø³ØªÙˆÙŠ_6: "1430989799510114444", Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ_Ù…Ø³ØªÙˆÙŠ_7: "1430989798478188626", Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ_Ù…Ø³ØªÙˆÙŠ_8: "1430989797316624384", Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ_Ù…Ø³ØªÙˆÙŠ_9: "1430989795848491108"},
    courses: { "Ù…Ù†ØªØ¯Ø¨": "1430989794569097216", "ØªØ¹Ø¯ÙŠÙ„ Ùˆ ØªØ²ÙˆÙŠØ¯": "1430989793373847552", "Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ÙÙ†ÙŠÙ†": "1430989792111497308", "ØªÙ†Ø¸ÙŠÙ…": "1430989790970380378", "ØªØµÙ†ÙŠØ¹": "1430989789678669894", "Ù‚Ø³Ù… Ø§Ù„ØªÙˆØ¸ÙŠÙ": "1430989788609253397", "Ø´Ø¤ÙˆÙ† Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„ÙƒØ±Ø§Ø¬": "1430989787044774060", "Ù…Ø´Ø±Ù Ø¹Ù€Ù€Ø§Ù… ": "1430989785484230787", " Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ÙˆØ´ÙˆÙ… ": "1430989784008097952", "Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©": "1430989782548349028", "Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©": "1430989781092798736", "Ù…Ø³Ø¤ÙˆÙ„ ØªØ°Ø§ÙƒØ± Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ": "1434867841844383804"}
  },
  fire: { // Ø¯ÙØ§Ø¹ Ù…Ø¯Ù†ÙŠ
    hireRoles: { trainee: "1430989775942451340", wkil_aref: "1430989774621114408" },
    courseRole: "ROLE_ID",
    ranksToRemove: ["1430989774621114408","1430989773409091584","1430989772297474059","1430989771043508304","1430989770003316906","1430989768707276931","1430989767901708358","1430989766865846453","1430989765783851049","1430989764252663979"],
    rankRoles: { Ù…Ø³Ø¹Ù_Ù…Ø³ØªÙˆÙŠ_1: "1430989773409091584", Ù…Ø³Ø¹Ù_Ù…Ø³ØªÙˆÙŠ_2: "1430989772297474059", Ù…Ø³Ø¹Ù_Ù…Ø³ØªÙˆÙŠ_3: "1430989771043508304", Ù…Ø³Ø¹Ù_Ù…Ø³ØªÙˆÙŠ_4: "1430989770003316906", Ù…Ø³Ø¹Ù_Ù…Ø³ØªÙˆÙŠ_5: "1430989768707276931", Ù…Ø³Ø¹Ù_Ù…Ø³ØªÙˆÙŠ_6: "1430989767901708358", Ù…Ø³Ø¹Ù_Ù…Ø³ØªÙˆÙŠ_7: "1430989766865846453", Ù…Ø³Ø¹Ù_Ù…Ø³ØªÙˆÙŠ_8: "1430989765783851049", Ù…Ø³Ø¹Ù_Ù…Ø³ØªÙˆÙŠ_9: "1430989764252663979" },
    courses: { "Ù…Ù†ØªØ¯Ø¨": "1430989762969206985", "Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø·ÙŠØ§Ø±": "1430989761656655922", "Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¬ÙˆÙŠ": "1430989760419205362", "Ø·Ø¨ÙŠØ¨ Ù…Ø¹ØªÙ…Ø¯": "1430989759144263790","Ø§Ù„Ø·Ø¨ Ø§Ù„Ø´Ø±Ø¹ÙŠ": "1430989758141825116","Ù‚Ø³Ù… Ø§Ù„ØªÙˆØ¸ÙŠÙ": "1430989756992589994","Ø´Ø¤ÙˆÙ† Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø¯ÙØ§Ø¹": "1430989755629305897","Ù…Ø´Ø±Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ": "1430989754517946462","Ù…Ø´Ø±Ù Ø¹Ù€Ù€Ø§Ù…": "1430989752810602738","Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ùˆ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©": "1430989751242064066","Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©": "1430989750122188800","Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ØªØ°Ø§ÙƒØ± Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ": "1434867871586193429" }
  }
};


async function sendMainPanel() {
  const channel = await client.channels.fetch(channelId);

  const embed = new EmbedBuilder()
    .setTitle("Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ðŸ”")
    .setDescription(`
- ** Control of Government Sectors  **

> **Ù„Ù„ØªØ­ÙƒÙ… Ø¨Ù„ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© Ù„ÙƒÙ„ Ù‚Ø·Ø§Ø¹**

- ** Allowed Rules  **

> ** Ù†Ø§Ø¦Ø¨ + Ù‚Ø§Ø¦Ø¯ + Ù…Ø´Ø±Ù ÙƒÙ„ Ù‚Ø·Ø§Ø¹ **
`)
    .setFooter({ text: "@Classic â€¢ City" });

  const row = new ActionRowBuilder().addComponents(
    new ButtonBuilder().setCustomId("sector_police").setLabel("Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø±Ø·Ø©").setStyle(ButtonStyle.Primary),
    new ButtonBuilder().setCustomId("sector_customs").setLabel("Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù…Ø§Ø±Ùƒ").setStyle(ButtonStyle.Primary),
    new ButtonBuilder().setCustomId("sector_garage").setLabel("ÙƒÙ€Ø±Ø§Ø¬ Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ").setStyle(ButtonStyle.Primary),
    new ButtonBuilder().setCustomId("sector_fire").setLabel("Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ").setStyle(ButtonStyle.Primary)
  );

  await channel.send({ embeds: [embed], components: [row] });
}

client.on("interactionCreate", async (interaction) => {
  if (!interaction.isButton()) return;
  if (!interaction.customId.startsWith("sector_")) return;

  const sectorKey = interaction.customId.replace("sector_", "");
  const sectorName = {
    police: "Ø§Ù„Ø´Ø±Ø·Ø©",
    customs: "Ø§Ù„Ø¬Ù…Ø§Ø±Ùƒ",
    garage: "Ø§Ù„ÙƒØ±Ø§Ø¬",
    fire: "Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ"
  }[sectorKey];

  const allowedRoles = {
    police: [
      "1430989712000291056",
      "1430989710930743336",
      "1436109670506037391"
    ],
    customs: [
      "1430989812227244135",
      "1430989811044581587",
      "1436434546496110592"
    ],
    fire: [
      "1430989749069549672",
      "1430989747702071387",
      "1436439948201951293"
    ],
    garage: [
      "1430989779608141985",
      "1430989778362564649",
      "1436435005831122974"
    ]
  };

  const member = interaction.member;

  const hasRole = member.roles.cache.some(role => allowedRoles[sectorKey].includes(role.id));
  if (!hasRole) {
    return interaction.reply({
      content: "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø¥Ø¯Ø§Ø±Ø© Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø·Ø§Ø¹.",
      ephemeral: true
    });
  }

  const modal = new ModalBuilder()
    .setCustomId(`modal_${sectorKey}`)
    .setTitle(`Ø£Ø¯Ø®Ù„ ID Ø§Ù„Ø´Ø®Øµ Ù„Ø¥Ø¯Ø§Ø±Ø© ${sectorName}`);

  const input = new TextInputBuilder()
    .setCustomId("user_id")
    .setLabel("ID Ø§Ù„Ø´Ø®Øµ")
    .setStyle(TextInputStyle.Short);

  modal.addComponents(new ActionRowBuilder().addComponents(input));

  await interaction.showModal(modal);
});

client.on("interactionCreate", async (interaction) => {
  if (!interaction.isModalSubmit()) return;
  if (!interaction.customId.startsWith("modal_")) return;

  const sectorKey = interaction.customId.replace("modal_", "");
  const userId = interaction.fields.getTextInputValue("user_id");

  const embed = new EmbedBuilder()
    .setTitle("Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸Ù")
    .setDescription(`**ID:** ${userId}`)
    .setFooter({ text: "@Classic" });

  const row = new ActionRowBuilder().addComponents(
    new ButtonBuilder().setCustomId(`hire_${sectorKey}_${userId}`).setLabel("ØªÙˆØ¸ÙŠÙ").setStyle(ButtonStyle.Success),
    new ButtonBuilder().setCustomId(`fire_${sectorKey}_${userId}`).setLabel("ÙØµÙ„").setStyle(ButtonStyle.Danger),
    new ButtonBuilder().setCustomId(`rank_${sectorKey}_${userId}`).setLabel("ØªØ±Ù‚ÙŠØ©/ØªØ®ÙÙŠØ¶").setStyle(ButtonStyle.Primary),
    new ButtonBuilder().setCustomId(`course_${sectorKey}_${userId}`).setLabel("Ø¥Ø¹Ø·Ø§Ø¡/Ø¥Ø²Ø§Ù„Ø© Ø¯ÙˆØ±Ø©").setStyle(ButtonStyle.Secondary)
  );

  await interaction.reply({ embeds: [embed], components: [row], flags: 64 });
});


client.on("interactionCreate", async (interaction) => {
  if (!interaction.isButton() || !interaction.customId.startsWith("hire_")) return;

  const [_, sectorKey, userId] = interaction.customId.split("_");
  const sector = SECTORS[sectorKey];

  await interaction.deferReply({ flags: 64 });

  const member = await interaction.guild.members.fetch(userId).catch(() => null);
  if (!member) return interaction.editReply("âŒ Ø§Ù„Ø¹Ø¶Ùˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");

  await member.roles.add(sector.hireRoles.trainee).catch(() => null);
  await member.roles.add(sector.hireRoles.wkil_aref).catch(() => null);

  return interaction.editReply("âœ… ØªÙ… ØªÙˆØ¸ÙŠÙ Ø§Ù„Ø¹Ø¶Ùˆ Ø¨Ù†Ø¬Ø§Ø­");
});

client.on("interactionCreate", async (interaction) => {
  if (!interaction.isButton() || !interaction.customId.startsWith("fire_")) return;

  const [_, sectorKey, userId] = interaction.customId.split("_");
  const sector = SECTORS[sectorKey];

  await interaction.deferReply({ flags: 64 });

  const member = await interaction.guild.members.fetch(userId).catch(() => null);
  if (!member) return interaction.editReply("âŒ Ø§Ù„Ø¹Ø¶Ùˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");

  for (const roleId of sector.ranksToRemove) await member.roles.remove(roleId).catch(() => null);

  await member.roles.remove(sector.hireRoles.trainee).catch(() => null);
  await member.roles.remove(sector.hireRoles.wkil_aref).catch(() => null);

  for (const roleId of Object.values(sector.courses)) await member.roles.remove(roleId).catch(() => null);

  return interaction.editReply("ðŸ—‘ï¸ ØªÙ… ÙØµÙ„ Ø§Ù„Ø¹Ø¶Ùˆ ÙˆØ­Ø°Ù ÙƒÙ„ Ø§Ù„Ø±ØªØ¨ ÙˆØ§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù‚Ø·Ø§Ø¹");
});

client.on("interactionCreate", async (interaction) => {
  if (!interaction.isButton() || !interaction.customId.startsWith("course_")) return;

  const [_, sectorKey, userId] = interaction.customId.split("_");
  const sector = SECTORS[sectorKey];

  const select = new StringSelectMenuBuilder()
    .setCustomId(`courseSelect_${sectorKey}_${userId}`)
    .setPlaceholder("Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ±Ø©â€¦");

  Object.keys(sector.courses).forEach((key) => {
    select.addOptions({ label: key, value: key });
  });

  select.addOptions({ label: "Ø¥Ø¹Ø·Ø§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆØ±Ø§Øª", value: "giveAll" });

  return interaction.reply({
    content: `Ø§Ø®ØªØ± Ø¯ÙˆØ±Ø© Ù„Ø¥Ø¯Ø§Ø±ØªÙ‡Ø§ Ù„Ù„Ø¹Ø¶Ùˆ **${userId}**`,
    components: [new ActionRowBuilder().addComponents(select)],
    flags: 64
  });
});

client.on("interactionCreate", async (interaction) => {
  if (!interaction.isButton() || !interaction.customId.startsWith("rank_")) return;

  const [_, sectorKey, userId] = interaction.customId.split("_");
  const sector = SECTORS[sectorKey];

  const select = new StringSelectMenuBuilder()
    .setCustomId(`rankSelect_${sectorKey}_${userId}`)
    .setPlaceholder("Ø§Ø®ØªØ± Ø§Ù„Ø±ØªØ¨Ø©â€¦");

  Object.keys(sector.rankRoles).forEach((key) => {
    select.addOptions({ label: key, value: key });
  });

  return interaction.reply({
    content: `Ø§Ø®ØªØ± Ø±ØªØ¨Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø¹Ø¶Ùˆ **${userId}**`,
    components: [new ActionRowBuilder().addComponents(select)],
    flags: 64
  });
});

client.on("interactionCreate", async (interaction) => {
  if (!interaction.isStringSelectMenu() || !interaction.customId.startsWith("rankSelect_")) return;

  const [_, sectorKey, userId] = interaction.customId.split("_");
  const selectedKey = interaction.values[0];
  const sector = SECTORS[sectorKey];
  const roleId = sector.rankRoles[selectedKey];

  await interaction.deferReply({ flags: 64 });

  const member = await interaction.guild.members.fetch(userId).catch(() => null);
  if (!member) return interaction.editReply("âŒ Ø§Ù„Ø¹Ø¶Ùˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");

  for (const r of sector.ranksToRemove) await member.roles.remove(r).catch(() => null);

  await member.roles.add(roleId).catch(() => null);

  return interaction.editReply(`âœ… ØªÙ… ØªØºÙŠÙŠØ± Ø±ØªØ¨Ø© Ø§Ù„Ø¹Ø¶Ùˆ Ø¥Ù„Ù‰ **${selectedKey}** Ø¨Ù†Ø¬Ø§Ø­`);
});


client.on("interactionCreate", async (interaction) => {
  if (!interaction.isStringSelectMenu() || !interaction.customId.startsWith("courseSelect_")) return;

  const [_, sectorKey, userId] = interaction.customId.split("_");
  const selectedKey = interaction.values[0];
  const sector = SECTORS[sectorKey];

  await interaction.deferReply({ flags: 64 });

  const member = await interaction.guild.members.fetch(userId).catch(() => null);
  if (!member) return interaction.editReply("âŒ Ø§Ù„Ø¹Ø¶Ùˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");

  if (selectedKey === "giveAll") {
    for (const r of Object.values(sector.courses)) {
      if (!member.roles.cache.has(r)) await member.roles.add(r).catch(() => null);
    }
    return interaction.editReply("ðŸŸ¢ ØªÙ… Ø¥Ø¹Ø·Ø§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù‚Ø·Ø§Ø¹");
  }

  const roleId = sector.courses[selectedKey];
  if (!roleId) return interaction.editReply("âŒ Ø§Ù„Ø¯ÙˆØ±Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©");

  if (member.roles.cache.has(roleId)) {
    await member.roles.remove(roleId);
    return interaction.editReply(`ðŸŸ¡ ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø¯ÙˆØ±Ø©: **${selectedKey}**`);
  }

  await member.roles.add(roleId);
  return interaction.editReply(`ðŸŸ¢ ØªÙ… Ø¥Ø¹Ø·Ø§Ø¡ Ø¯ÙˆØ±Ø©: **${selectedKey}**`);
});

client.on("clientReady", async () => {
  console.log(`Logged in as ${client.user.tag} Nada Bot is Sucssfully Logged in âœ…`);
  await sendMainPanel();
});

client.login(token);
